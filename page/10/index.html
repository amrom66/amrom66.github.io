<!DOCTYPE html>
<html lang="en-us">
  <head>
	<meta name="generator" content="Hugo 0.64.1" />
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  <meta name="author" content="linjinbao66">
  <meta name="description" content="打工人日记">
  <meta name="keywords" content="博客 个人 日记">
  
  
  
  <link rel="canonical" href="https://linjinbao.github.io/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
           打工人日记
       
  </title>
  <meta name="title" content="打工人日记">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
    <link href="https://linjinbao.github.io/index.xml" rel="alternate" type="application/rss+xml" title="打工人日记" />
    <link href="https://linjinbao.github.io/index.xml" rel="feed" type="application/rss+xml" title="打工人日记" />
  
  

<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "url": "https:\/\/linjinbao.github.io\/",
    "name": "打工人日记",
    "author": {
        "@type": "Person",
        "name": "linjinbao66"
    },
    "description": "打工人日记",
}
</script>
 

</head>

  


  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://linjinbao.github.io">打工人日记</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts" title="">博客</a>
                
                <a class="menu-item" href="/categories/" title="">分类</a>
                
                <a class="menu-item" href="/tags/" title="">标签</a>
                
                <a class="menu-item" href="/2020/about/" title="关于">关于</a>
                
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
     <div class="container">
        <div class="navbar-header">
            <div>
                <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;
                <a href="https://linjinbao.github.io">打工人日记</a>
            </div>
            <div class="menu-toggle">
                <svg t="1618556759902" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1299" width="16" height="16"><path d="M896 1024h-213.333333a128 128 0 0 1-128-128v-213.333333a128 128 0 0 1 128-128h213.333333a128 128 0 0 1 128 128v213.333333a128 128 0 0 1-128 128z m-213.333333-384a42.666667 42.666667 0 0 0-42.666667 42.666667v213.333333a42.666667 42.666667 0 0 0 42.666667 42.666667h213.333333a42.666667 42.666667 0 0 0 42.666667-42.666667v-213.333333a42.666667 42.666667 0 0 0-42.666667-42.666667z m-341.333334 384H128a128 128 0 0 1-128-128v-213.333333a128 128 0 0 1 128-128h213.333333a128 128 0 0 1 128 128v213.333333a128 128 0 0 1-128 128z m-213.333333-384a42.666667 42.666667 0 0 0-42.666667 42.666667v213.333333a42.666667 42.666667 0 0 0 42.666667 42.666667h213.333333a42.666667 42.666667 0 0 0 42.666667-42.666667v-213.333333a42.666667 42.666667 0 0 0-42.666667-42.666667z m768-170.666667h-213.333333a128 128 0 0 1-128-128V128a128 128 0 0 1 128-128h213.333333a128 128 0 0 1 128 128v213.333333a128 128 0 0 1-128 128z m-213.333333-384a42.666667 42.666667 0 0 0-42.666667 42.666667v213.333333a42.666667 42.666667 0 0 0 42.666667 42.666667h213.333333a42.666667 42.666667 0 0 0 42.666667-42.666667V128a42.666667 42.666667 0 0 0-42.666667-42.666667z m-341.333334 384H128a128 128 0 0 1-128-128V128a128 128 0 0 1 128-128h213.333333a128 128 0 0 1 128 128v213.333333a128 128 0 0 1-128 128zM128 85.333333a42.666667 42.666667 0 0 0-42.666667 42.666667v213.333333a42.666667 42.666667 0 0 0 42.666667 42.666667h213.333333a42.666667 42.666667 0 0 0 42.666667-42.666667V128a42.666667 42.666667 0 0 0-42.666667-42.666667z" p-id="1300"></path></svg>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts" title="">博客</a>
                
                <a class="menu-item" href="/categories/" title="">分类</a>
                
                <a class="menu-item" href="/tags/" title="">标签</a>
                
                <a class="menu-item" href="/2020/about/" title="关于">关于</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
      		
  	
  	
<div class="post-warp">
	<div class="intro">
    
    
    
    <div class="avatar">
        <a href="/"> <img src="/images/me/avatar.jpg"> </a>
    </div>
    
    
    <h2 class="description">
       Across the great wall, we can reach the world
    </h2>
    
 
</div>
	
		<article class="post" itemscope itemscope="" itemtype="http://schema.org/Article">

			<header class="post-header">
				<h1 class="post-title" itemprop="name headline"><a href="https://linjinbao.github.io/2021/2021-05-10-%E4%BA%91%E5%8E%9F%E7%94%9F%E6%97%B6%E4%BB%A3%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86%E6%96%B9%E6%A1%88%E6%B5%85%E8%B0%88/">云原生时代日志采集方案浅谈</a></h1>
			</header>
			<div class="post-content">
				 
				   
       			 
				引言 本文基于kubernetes容器平台，分析容器日志采集的前因后果，通过比对EFK和Loki的方案，讨论云原生时代容器日志收集与分析的重点所在。
当服务从裸机部署进入容器时代，容器的强大隔离性与封装性，使得服务的日志变得不稳定。原本裸机运行的程序使用容器运行时，极易由于自动重启，或者自动重建等特性而丢失日志，即便采用了持久化挂载，依然无法根本问题：日志易丢失。对于一个大规模集群而言，完善的日志收集变得越来越重要。
需要采集日志的场景 可以说，基本上所有的程序的日志都应该采集，即使是那些一次性的job等。日志的采集不仅仅是提供给排查bug人员，而且应当作为系统审计的角色存在。收集整个容器平台的所有日志看起来是件多余的事情，毕竟大多数的日志并无用处，但是对于严谨的业务而言，日志是发现问题的最佳途径。
方案一 EFK 就kubernetes平台而言，日志的采集方案比较流行的有EFK，其中E是指elasticsearch，K是指kibana，但是F，有两种说法，一种是指fluentd，另一种是指filebeat；一般分析认为，fluentd相比较于filebeat属于重量级程序。本文任务此处为fluentd。EFK方案的架构很明确，fluentd以DaemonSet形式运行在集群所有节点上，在即指定路径的宿主机日志，例如：/var/log/pods；fluentd采集到日志后，传输到elasticsearch存储，elastic作为一个强大的全文检索引擎，具备良好的并发存储于查询的能力；kibana作为日志的展示工具。
EFK方案实现起来比较成熟，目前多数的方案都是用的是这种，包括k8s官方提供的插件中就有此种方案。但是该方案存在明显的缺陷：
 Elastic Search 的编写语言是Java，其运行时非常占用内存，有时需要把elastic移除到集群外部部署。 Elastic Search存储的内容虽然比较多，但是大多数并不需要采集。  方案二 Loki Loki是近期比较流行的k8s日志采集方案。博主认为，说Loki是日志采集方案其实是不准确的。先来看Loki采集的原理：
Loki也采用了代理程序与服务端结合的设计：
			</div>
			<div class="post-footer">
				<div class="post-meta">
                <span class="post-time">
                <time datetime=2021-05-10 itemprop="datePublished">May 10, 2021</time>
                </span>
                in
                
        </div>
				
				<div class="post-tags">
        		
        			<span class="tag"><a href="https://linjinbao.github.io/tags/kubernetes/">
               	 #kubernetes</a></span>
        		
				</div>
				
			</div>
		</article>
	
		<article class="post" itemscope itemscope="" itemtype="http://schema.org/Article">

			<header class="post-header">
				<h1 class="post-title" itemprop="name headline"><a href="https://linjinbao.github.io/2021/2021-05-07-frp%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E7%9A%84%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8/">frp反向代理的实际应用</a></h1>
			</header>
			<div class="post-content">
				 
				   
       			 
				frp介绍 frp是一个实现内网穿透的程序，通过客户端（内网）与服务端（外网）建立的持续信道，实现内网程序映射到外网。其原理大致为：服务端坚挺固定的几个端口；流量到达服务端端口；流量交给客户端处理，客户端转发流量到指定服务。
示例  服务端  /etc/systemd/system/frps.service
[Unit] Description=Frp Server Service After=network.target [Service] Type=simple User=root Restart=on-failure RestartSec=600s ExecStart=/usr/local/bin/frps -c /etc/frp/frps.ini [Install] WantedBy=multi-user.
			</div>
			<div class="post-footer">
				<div class="post-meta">
                <span class="post-time">
                <time datetime=2021-05-07 itemprop="datePublished">May 7, 2021</time>
                </span>
                in
                
        </div>
				
			</div>
		</article>
	
		<article class="post" itemscope itemscope="" itemtype="http://schema.org/Article">

			<header class="post-header">
				<h1 class="post-title" itemprop="name headline"><a href="https://linjinbao.github.io/2021/2021-05-07-helm-minio/">helm minio</a></h1>
			</header>
			<div class="post-content">
				 
				   
       			 
				minio部署 helm repo add minio https://helm.min.io/ helm install minio \ --namespace minio --create-namespace \ --set accessKey=minio,secretKey=minio123 \ --set mode=standalone \ --set service.
			</div>
			<div class="post-footer">
				<div class="post-meta">
                <span class="post-time">
                <time datetime=2021-05-07 itemprop="datePublished">May 7, 2021</time>
                </span>
                in
                
        </div>
				
			</div>
		</article>
	
		<article class="post" itemscope itemscope="" itemtype="http://schema.org/Article">

			<header class="post-header">
				<h1 class="post-title" itemprop="name headline"><a href="https://linjinbao.github.io/2021/2021-05-05-%E4%BB%80%E4%B9%88%E6%98%AFdevops/">什么是DevOps</a></h1>
			</header>
			<div class="post-content">
				 
				   
       			 
				什么是DevOps：
维基百科的解释：https://en.wikipedia.org/wiki/DevOps
 DevOps is a set of practices that combines software development (Dev) and IT operations (Ops). It aims to shorten the systems development life cycle and provide continuous delivery with high software quality.
			</div>
			<div class="post-footer">
				<div class="post-meta">
                <span class="post-time">
                <time datetime=2021-05-05 itemprop="datePublished">May 5, 2021</time>
                </span>
                in
                
        </div>
				
			</div>
		</article>
	
		<article class="post" itemscope itemscope="" itemtype="http://schema.org/Article">

			<header class="post-header">
				<h1 class="post-title" itemprop="name headline"><a href="https://linjinbao.github.io/2021/2021-04-14-%E5%88%86%E4%BA%AB/">分享</a></h1>
			</header>
			<div class="post-content">
				 
				   
       			 
				
			</div>
			<div class="post-footer">
				<div class="post-meta">
                <span class="post-time">
                <time datetime=2021-04-14 itemprop="datePublished">April 14, 2021</time>
                </span>
                in
                
        </div>
				
			</div>
		</article>
	

	

<ul class="pagination">
    
    
    
    
    
    
    
    
    
    
        
        
    
    
    <li class="page-item ">
        <span class="page-link">
            <a href="/">1</a></li>
        </span>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item "><span class="page-link" aria-hidden="true">&hellip;</span></li>
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    <li class="page-item ">
        <span class="page-link">
            <a href="/page/8/">8</a></li>
        </span>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item ">
        <span class="page-link">
            <a href="/page/9/">9</a></li>
        </span>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item active">
        <span class="page-link">
            <a href="/page/10/">10</a></li>
        </span>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item ">
        <span class="page-link">
            <a href="/page/11/">11</a></li>
        </span>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item ">
        <span class="page-link">
            <a href="/page/12/">12</a></li>
        </span>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item "><span class="page-link" aria-hidden="true">&hellip;</span></li>
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    <li class="page-item ">
        <span class="page-link">
            <a href="/page/23/">23</a></li>
        </span>
    
    
    
    
</ul>

</div>

  

          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2019 - 2021</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="https://linjinbao.github.io">linjinbao66</a>  </span> 
         

         
		 
    </div>
</footer>











    
    <script src="/js/vendor_main.min.js" async=""></script>



     </div>
  </body>
</html>
